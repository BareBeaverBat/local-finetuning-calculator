{
    "name": "gemma_2b",
    "num_embed_params": 524550144,
    "num_non_embed_params": 1981884416,
    "__comment_num_non_embed_params": "todo use num_non_embed_params to sanity-check the computation of that from # layers, d_model, feed-forward hidden dim, num query heads, head size, vocab size",
    "num_layers": 18,
    "model_dim": 2048,
    "feed_forward_hidden_dim": 32768,
    "__comment_on_feed_forward_hidden_dim": "this is the total width to which the representations get expanded in the hidden layer of the feed-forward block, but b/c this has gated MLP blocks the up projection and the gate projection actually both have a width that's 1/2 of this number",
    "num_query_heads": 8,
    "num_kv_heads": 1,
    "__comment_num_kv_heads": "keeping this option as numeric so this format can describe multi-query and multi-head attention models as well as any grouped-query attention model without an enum option for switching between those",
    "head_size": 256,
    "vocab_size": 256128,
    "embed_module_name": "embed_tokens",
    "attn_module_names": ["q_proj", "k_proj", "v_proj", "o_proj"],
    "mlp_module_names": ["gate_proj", "up_proj", "down_proj"],
    "is_mlp_gated": true,
    "__comment_divider1": "the above are for principled considerations, the below for hacks to get around pytorch's/bitsandbytes' frustratingly coarse-grained and hard-to-understand memory allocation behavior",
    "initial_massive_params_chunk_size": 1048576000,
    "__comment_initial_massive_params_chunk": "this is the size of the big params chunk which is allocated at the start of the base-model-weights-4bit-quantization process and then deallocated immediately after the quantization process is done _and after_ the persistent massive params chunk is _allocated_",
    "total_size_of_frozen_weight_small_tensors": 1022637056,
    "__comment_total_size_of_frozen_weight_small_tensors": "this is the total size of the frozen weight tensors that are built up during the base-model-weights-4bit-quantization process and then persist throughout the training run",
    "persistent_massive_params_chunk_size": 2097152000,
    "__comment_persistent_massive_params_chunk": "this is the size of the big params chunk which is allocated at the end of the base-model-weights-4bit-quantization process is done and then persists through the rest of the training process"
}